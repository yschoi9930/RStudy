test <- str_split(com_list2[1:10],"/")
test
# N외에 N+인 것도 추출이 필요함
sel_N <- function(x){
if(str_detect(x[2],"N")){
x[1]
} else{
}
}
sapply(test,sel_N)
# 전체 데이터에 대해서 진행
spl_data<-str_split(com_list2,"/")
words <- sapply(spl_data, sel_N)
sum(spl_data==" ")
sum(spl_data=="  ")
# 데이터가 없는 위치의 인덱스 검색
which(spl_data==" ")
spl_data[8245]
# --- simplePos09 함수가 명사라고 인식한 단어 추출
spl_data <- str_split(com_list2)
# --- simplePos09 함수가 명사라고 인식한 단어 추출
spl_data <- str_split(com_list2."/")
# --- simplePos09 함수가 명사라고 인식한 단어 추출
spl_data <- str_split(com_list2,"/")
sel_N <- function(x){
if(length(x)>1) {
if(str_detect(x[2],"N")){
x[1]
} else{
}
} else{
}
}
spl_data<-str_split(com_list2,"/")
words <- sapply(spl_data, sel_N)
words %>%  head()
count <- tabel(words)
count_f <- table(words)
words <- words %>% unlist()
count_f <- table(words)
count_f <- sort(count_f, decreasing = TRUE)
count_f
count_f[1:20]
count_f <- table(words)
sort(count_n, decreasing = TRUE)[1:20]
count_n <- table(words)
sort(count_n, decreasing = TRUE)[1:20]
sort(count, decreasing = TRUE)[1:20]
words <- sapply(spl_data, sel_P)
# 동사 명사 분류
sel_P <- function(x){
if(length(x)>1) {
if(str_detect(x[2],"P")){
x[1]
} else{
}
} else{
}
}
words <- sapply(spl_data, sel_P)
words <- words %>% unlist()
count_p <- table(words)
all_noun <- sort(count, decreasing = TRUE)[1:20]
noun <- sort(count_n, decreasing = TRUE)[1:20]
p <- sort(count_p, decreasing = TRUE)[1:20]
count_p <- count_p[nchar(names(count_p))>1]
all_noun <- sort(count, decreasing = TRUE)[1:20]
noun <- sort(count_n, decreasing = TRUE)[1:20]
p <- sort(count_p, decreasing = TRUE)[1:20]
head(all_noun,20)
head(noun,20)
head(p,20)
load('comments.Rdata')
load('score.Rdata')
head(comments,2)
head(score,2)
# 사전을 이용한 감성 분석
library(KoNLP)
library(wordcloud)
library(wordcloud2)
# --sample을 추출해서 확인
sample_index <- sample(1: length(comments),10000)
sample_index
sample_index
# 데이터 추출
sample_com <- comments[sample_index]
head(sample_com)
# --sample을 추출해서 확인
sample_index <- sample(1: length(comments),1000)
# 데이터 추출
sample_com <- comments[sample_index]
# SimplePos09('꺼지라그래 서비스 진짜 꽝임')
sample_score <- score[sample_index]
head(sample_score)
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
}
head(sample_com)
com_list[[1]]
sample_index
head(sample_com)
sapply(str_split(com_list[[1]],"/"),function(X){x[1]})
com_list[[1]]
sapply(str_split(com_list[[1]],"/"),function(X){x[1]})
com_list[[1]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
head(com_list)
head(com_list2)
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
}
com_list[[1]]
com_list2 <- unlist(com_list)
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list2,sel)
head(com_list2)
sum(nega %in% com_list2[[3]])
nega[(nega %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
nage <- c("맛 없",'낚였네요','밥맛뚝뚝','맛은별로','접으세요','싫','시켜먹',
'없으신가봐요','절대','더럽럽')
posi <- c('합리적인','호강','맛있','정말강추','좋았','최고','맛있습니',
'친절하네','친절하','친절합니','진짜맛','정말강')
nega[(nega %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
nega <- c("맛 없",'낚였네요','밥맛뚝뚝','맛은별로','접으세요','싫','시켜먹',
'없으신가봐요','절대','더럽럽')
nega[(nega %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[3]])
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
}
com_list[[1]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
load('comments.Rdata')
load('score.Rdata')
# --sample을 추출해서 확인
sample_index <- sample(1: length(comments),1000)
sample_index
# 데이터 추출
sample_com <- comments[sample_index]
head(sample_com)
# SimplePos09('꺼지라그래 서비스 진짜 꽝임')
sample_score <- score[sample_index]
head(sample_score)
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
}
com_list[[1]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
nega[(nega %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[3]])
nega[(nega %in% com_list2[[4]])] # [1] '절대','더럽' : -2점
nega[(nega %in% com_list2[[5]])] # [1] '절대','더럽' : -2점
head(com_list2)
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
cat('\n',i)
}
com_list[[1]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
comments[2]
sample_index
head(sample_com)
head(sample_score)
sample_score
com_list[[1]]
sapply(str_split(com_list,"/"),function(com_list){com_list[1]}
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
head(sample_com)
SimplePos09(sample_com[2])
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[2])))=='try-error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
cat('\n',i)
}
s_token
if(class(try(s_token <- SimplePos09(sample_com[2])))=='try-error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
cat('\n',i)
if(class(try(s_token <- SimplePos09(sample_com[2])))=='try-error'){
com_list[[2]] <- NA
} else {
com_list[[2]] <- s_token
}
cat('\n',2)
com_list[[2]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
com_list2 <- sapply(com_list[[2]],sel)
head(com_list2)
# 모든 리뷰에 대하여 형태소를 확인
j=6
posi_list[[j]] <- posi[(posi %in% com_list2[[j]])]
nega_list[[j]] <- nega[(nega %in% com_list2[[j]])]
posi_score <- sum(posi %in% com_list2[[j]]) # 긍정점수
nega_score <- -sum(nega %in% com_list2[[j]]) # 부정점수
text_score <- posi_score + nega_score # 긍/부정 합산
score_list[j] <- text_score
posi_list[[j]] <- posi[(posi %in% com_list2[[j]])]
nega_list[[j]] <- nega[(nega %in% com_list2[[j]])]
posi_score <- sum(posi %in% com_list2[[j]]) # 긍정점수
nega_score <- -sum(nega %in% com_list2[[j]]) # 부정점수
text_score <- posi_score + nega_score # 긍/부정 합산
nega_score
text_score
posi_score
nega_list
posi_list
# ----------- 형태소 분석기 돌리는 코드
com_list <- list()
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try-error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
cat('\n',2)
}
for (i in 1:length(sample_com)) {
if(class(try(s_token <- SimplePos09(sample_com[i])))=='try-error'){
com_list[[i]] <- NA
} else {
com_list[[i]] <- s_token
}
cat('\n',i)
}
com_list[[2]]
# 함수로 구현
sel <- function(x){
sapply(str_split(x,"/"),function(X){x[1]})
}
# 함수로 구현
sel <- function(x){
str_split(x,"/"),function(X){x[1]}
}
str_split(com_list[[2]],"/")
com_list[[2]][1]
sapply(str_split(com_list[[2]],"/"),function(com_list[[2]]){com_list[[2]][1]})
com_list[[2]][1]
a <- com_list[[2]]
str_split(a,"/")
a[1]
sapply(str_split(a,"/"),function(a){a[1]})
sel <- function(x){
sapply(str_split(x,"/"),function(x){x[1]})
}
com_list2 <- sapply(com_list,sel)
head(com_list2)
nega[(nega %in% com_list2[[5]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[3]])
posi[(posi %in% com_list2[[5]])] # [1] '절대','더럽' : -2점
sum(posi %in% com_list2[[3]])
posi_list <- list()
nega_list <- list()
score_list <- c()
for(j in 1: length(com_list2)) {
posi_list[[j]] <- posi[(posi %in% com_list2[[j]])]
nega_list[[j]] <- nega[(nega %in% com_list2[[j]])]
posi_score <- sum(posi %in% com_list2[[j]]) # 긍정점수
nega_score <- -sum(nega %in% com_list2[[j]]) # 부정점수
text_score <- posi_score + nega_score # 긍/부정 합산
score_list[j] <- text_score
cat("\n",j)
}
hist(score_list)
final_score <- ifelse(score_list) > 0, "긍정", '부정')
table(final_scoe)
final_score <- ifelse((score_list) > 0, "긍정", '부정')
table(final_scoe)
table(final_scoe)
table(final_score)
# 예측결과 확인
# sample_score 파일에 평점이 있고 추출은 sample_com과 같은 indext에서 추출
# 3점보다 높으면 긍정, 아니면 부정
true_score <- ifelse(sample_score>3,'긍정','부정')
table(true_score)
# 예측율 계산
sum(final_score==true_score)/1000
# 예측이 틀린 데이터를 확인해서 역추적
which(final_score != true_score)
sample_score[551]
sample_com[551]
final_score[551]
posi <- c('합리적인','호강','맛있','정말강추','좋았','최고','맛있습니',
'친절하네','친절하','친절합니','진짜맛','정말강','매력있어요')
nega <- c("맛 없",'낚였네요','밥맛뚝뚝','맛은별로','접으세요','싫','시켜먹',
'없으신가봐요','절대','더럽','미숙함','썰렁','맛도없다','불친절',
'망','꺼지라','꽝')
index <- 551
sample_score[551]
sample_com[551]
true_score[551]
# 예측율 계산
sum(final_score==true_score)/1000
# 예측이 틀린 데이터를 확인해서 역추적
which(final_score != true_score)
index <- 551
sample_score[551] # 수집
for(j in 1: length(com_list2)) {
posi_list[[j]] <- posi[(posi %in% com_list2[[j]])]
nega_list[[j]] <- nega[(nega %in% com_list2[[j]])]
posi_score <- sum(posi %in% com_list2[[j]]) # 긍정점수
nega_score <- -sum(nega %in% com_list2[[j]]) # 부정점수
text_score <- posi_score + nega_score # 긍/부정 합산
score_list[j] <- text_score
cat("\n",j)
}
hist(score_list)
final_score <- ifelse((score_list) > 0, "긍정", '부정')
table(final_score)
# 예측결과 확인
# sample_score 파일에 평점이 있고 추출은 sample_com과 같은 indext에서 추출
# 3점보다 높으면 긍정, 아니면 부정
true_score <- ifelse(sample_score>3,'긍정','부정')
table(true_score)
# 예측율 계산
sum(final_score==true_score)/1000
index <- 551
sample_score[551] # 수집
sample_com[551] # 수집
final_score[551] # 예측
# 형태소를 보고 계속 추가
nega_txt <- comments[score==1][1:10]
nega_txt
SimplePos09(nega_txt)
head(score,2)
head(score,10)
posi_txt <- comments[score==5][1:10]
posi_txt
SimplePos09(posi_txt)
posi <- c('합리적인','호강','맛있','정말강추','좋았','최고','맛있습니',
'친절하네','친절하','친절합니','진짜맛','정말강','매력있어요',
'강추','합리적')
nega <- c("맛없",'낚였네요','밥맛뚝뚝','맛은별로','접으세요','싫','시켜먹',
'없으신가봐요','절대','더럽','미숙함','썰렁','맛도없다','불친절',
'망','꺼지라','꽝','못하네요', '가관','비추이','느려터짐', '비위생',
'싫은','접으세요','')
head(com_list2)
nega[(nega %in% com_list2[[5]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[3]])
posi[(posi %in% com_list2[[5]])] # [1] '절대','더럽' : -2점
sum(posi %in% com_list2[[3]])
nega[(nega %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[3]])
posi[(posi %in% com_list2[[3]])] # [1] '절대','더럽' : -2점
sum(posi %in% com_list2[[3]])
com_list2[[3]]
com_list2[[7]]
com_list2[[10]]
com_list2[[1]]
com_list2[[2]]
com_list2[[4]]
nega[(nega %in% com_list2[[4]])] # [1] '절대','더럽' : -2점
sum(nega %in% com_list2[[4]])
posi[(posi %in% com_list2[[4]])] # [1] '절대','더럽' : -2점
sum(posi %in% com_list2[[4]])
# 모든 리뷰에 대하여 형태소를 확인
posi_list <- list()
nega_list <- list()
score_list <- c()
nega %in% com_list2[[4]]
posi %in% com_list2[[4]]
[(posi %in% com_list2[[4]])]
posi[(posi %in% com_list2[[4]])]
sum(posi %in% com_list2[[4]])
for(j in 1: length(com_list2)) {
posi_list[[j]] <- posi[(posi %in% com_list2[[j]])]
nega_list[[j]] <- nega[(nega %in% com_list2[[j]])]
posi_score <- sum(posi %in% com_list2[[j]]) # 긍정점수
nega_score <- -sum(nega %in% com_list2[[j]]) # 부정점수
text_score <- posi_score + nega_score # 긍/부정 합산
score_list[j] <- text_score
cat("\n",j)
}
hist(score_list)
final_score <- ifelse((score_list) > 0, "긍정", '부정')
table(final_score)
# 예측결과 확인
# sample_score 파일에 평점이 있고 추출은 sample_com과 같은 indext에서 추출
# 3점보다 높으면 긍정, 아니면 부정
true_score <- ifelse(sample_score>3,'긍정','부정')
table(true_score)
# 예측율 계산
sum(final_score==true_score)/1000
final_score==true_score
final_score
# 예측율 계산
sum(final_score==true_score)/1000
# 예측이 틀린 데이터를 확인해서 역추적
which(final_score != true_score)
index <- 823
sample_score[551] # 수집
sample_com[551] # 수집
final_score[551] # 예측
sample_score[823] # 수집
sample_com[823] # 수집
sample_com[823] # 수집
true_score[823]
final_score[823] # 예측
sample_score[823] # 수집
true_score[823]
final_score[823] # 예측
score_list[823]
posi_dic <- readLines('posi_dict.txt')
posidic %>% head()
posi_dic %>% head()
head(posi_dic,50)
posi_dic <- readLines('posi_dict.txt', encoding = 'UTF-8')
head(posi_dic,50)
nega_dic <- readLines('nega_dict.txt',encoding='UTF-8')
head(nega_dic,50)
posi
posi_dic_list <- list()
nega_dic_list <- list()
score_dic_list <- c()
for(j in 1: length(com_list2)) {
posi_dic_list[[j]] <- posi_dic[(posi_dic %in% com_list2[[j]])]
nega_dic_list[[j]] <- nega_dic[(nega_dic %in% com_list2[[j]])]
posi_dic_score <- sum(posi_dic %in% com_list2[[j]]) # 긍정점수
nega_dic_score <- -sum(nega_dic %in% com_list2[[j]]) # 부정점수
text_dic_score <- posi_dic_score + nega_dic_score # 긍/부정 합산
score_dic_list[j] <- text_dic_score
cat("\n",j)
}
hist(score_dic_list)
final_score <- ifelse((score_dic_list) > 0, "긍정", '부정')
table(final_dic_score)
final_dic_score <- ifelse((score_dic_list) > 0, "긍정", '부정')
table(final_dic_score)
# 예측결과 확인
# sample_score 파일에 평점이 있고 추출은 sample_com과 같은 indext에서 추출
# 3점보다 높으면 긍정, 아니면 부정
true_score <- ifelse(sample_score>3,'긍정','부정')
table(true_score)
# 예측율 계산
sum(final_score==true_score)/1000
# 예측이 틀린 데이터를 확인해서 역추적
which(final_score != true_score)
